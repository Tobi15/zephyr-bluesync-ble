<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bluesync in BLE Mesh: include/bluesync/bluesync.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Bluesync in BLE Mesh<span id="projectnumber">&#160;1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_f66431b314d9c7e0a76d19a1ca7b69d5.html">bluesync</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">bluesync.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;zephyr/kernel.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bluesync.h:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h__incl.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h" id="ainclude_2bluesync_2bluesync_8h">
<area shape="rect" title=" " alt="" coords="5,5,188,31"/>
<area shape="rect" title=" " alt="" coords="43,79,150,105"/>
<area shape="poly" title=" " alt="" coords="99,31,99,63,94,63,94,31"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h__dep__incl.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8hdep" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8hdep" id="ainclude_2bluesync_2bluesync_8hdep">
<area shape="rect" title=" " alt="" coords="122,5,305,31"/>
<area shape="rect" href="bluesync_8c.html" title=" " alt="" coords="5,86,110,112"/>
<area shape="poly" title=" " alt="" coords="177,41,83,88,80,84,175,36"/>
<area shape="rect" href="bs__state__machine_8c.html" title=" " alt="" coords="134,86,293,112"/>
<area shape="poly" title=" " alt="" coords="216,47,216,86,211,86,211,47"/>
<area shape="rect" href="synced__time__logger_8c.html" title=" " alt="" coords="317,79,451,120"/>
<area shape="poly" title=" " alt="" coords="255,35,343,76,340,81,252,40"/>
</map>
</div>
</div>
<p><a href="include_2bluesync_2bluesync_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab90d76e2e617bc596e11fe05aa0b310b" id="r_ab90d76e2e617bc596e11fe05aa0b310b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a> { <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021">BLUESYNC_NONE_ROLE</a> = 0
, <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a> = 1
, <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09">BLUESYNC_CLIENT_ROLE</a> = 2
 }</td></tr>
<tr class="separator:ab90d76e2e617bc596e11fe05aa0b310b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a722991b2960886eaf99895ba3395176f" id="r_a722991b2960886eaf99895ba3395176f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a722991b2960886eaf99895ba3395176f">bluesync_init</a> ()</td></tr>
<tr class="memdesc:a722991b2960886eaf99895ba3395176f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the BlueSync time synchronization module.  <br /></td></tr>
<tr class="separator:a722991b2960886eaf99895ba3395176f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fd22af69afb2d05130825f473adda13" id="r_a0fd22af69afb2d05130825f473adda13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fd22af69afb2d05130825f473adda13">bluesync_set_role</a> (<a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a> role)</td></tr>
<tr class="memdesc:a0fd22af69afb2d05130825f473adda13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the operational role of the BlueSync node.  <br /></td></tr>
<tr class="separator:a0fd22af69afb2d05130825f473adda13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4690b69707910bec50799ce1911f4af2" id="r_a4690b69707910bec50799ce1911f4af2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4690b69707910bec50799ce1911f4af2">bluesync_start_net_sync</a> ()</td></tr>
<tr class="memdesc:a4690b69707910bec50799ce1911f4af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates a new BlueSync synchronization round as the time authority.  <br /></td></tr>
<tr class="separator:a4690b69707910bec50799ce1911f4af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523e1397bf700b1ab25182c0db4017c6" id="r_a523e1397bf700b1ab25182c0db4017c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a523e1397bf700b1ab25182c0db4017c6">bluesync_start_net_sync_with_unix_epoch_us</a> (uint64_t unix_epoch_us)</td></tr>
<tr class="memdesc:a523e1397bf700b1ab25182c0db4017c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates a new BlueSync synchronization round as the time authority.  <br /></td></tr>
<tr class="separator:a523e1397bf700b1ab25182c0db4017c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a120ece7e147c0a90b3b973645f49af53" id="r_a120ece7e147c0a90b3b973645f49af53"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a120ece7e147c0a90b3b973645f49af53">get_current_unix_time_us</a> (void)</td></tr>
<tr class="memdesc:a120ece7e147c0a90b3b973645f49af53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time which is based on the UNIX reference.  <br /></td></tr>
<tr class="separator:a120ece7e147c0a90b3b973645f49af53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ab90d76e2e617bc596e11fe05aa0b310b" name="ab90d76e2e617bc596e11fe05aa0b310b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90d76e2e617bc596e11fe05aa0b310b">&#9670;&#160;</a></span>bluesync_role_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021" name="ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021"></a>BLUESYNC_NONE_ROLE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a" name="ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a"></a>BLUESYNC_AUTHORITY_ROLE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09" name="ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09"></a>BLUESYNC_CLIENT_ROLE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="include_2bluesync_2bluesync_8h_source.html#l00029">29</a> of file <a class="el" href="include_2bluesync_2bluesync_8h_source.html">bluesync.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>             {</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021">BLUESYNC_NONE_ROLE</a> = 0,</div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a> = 1,</div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09">BLUESYNC_CLIENT_ROLE</a> = 2</div>
<div class="line"><span class="lineno">   33</span>} <a class="code hl_enumeration" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a>;</div>
<div class="ttc" id="ainclude_2bluesync_2bluesync_8h_html_ab90d76e2e617bc596e11fe05aa0b310b"><div class="ttname"><a href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a></div><div class="ttdeci">bluesync_role_t</div><div class="ttdef"><b>Definition</b> <a href="include_2bluesync_2bluesync_8h_source.html#l00029">bluesync.h:29</a></div></div>
<div class="ttc" id="ainclude_2bluesync_2bluesync_8h_html_ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09"><div class="ttname"><a href="#ab90d76e2e617bc596e11fe05aa0b310ba70989cd36253d204270feb42c8fdaa09">BLUESYNC_CLIENT_ROLE</a></div><div class="ttdeci">@ BLUESYNC_CLIENT_ROLE</div><div class="ttdef"><b>Definition</b> <a href="include_2bluesync_2bluesync_8h_source.html#l00032">bluesync.h:32</a></div></div>
<div class="ttc" id="ainclude_2bluesync_2bluesync_8h_html_ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021"><div class="ttname"><a href="#ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021">BLUESYNC_NONE_ROLE</a></div><div class="ttdeci">@ BLUESYNC_NONE_ROLE</div><div class="ttdef"><b>Definition</b> <a href="include_2bluesync_2bluesync_8h_source.html#l00030">bluesync.h:30</a></div></div>
<div class="ttc" id="ainclude_2bluesync_2bluesync_8h_html_ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a"><div class="ttname"><a href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a></div><div class="ttdeci">@ BLUESYNC_AUTHORITY_ROLE</div><div class="ttdef"><b>Definition</b> <a href="include_2bluesync_2bluesync_8h_source.html#l00031">bluesync.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a722991b2960886eaf99895ba3395176f" name="a722991b2960886eaf99895ba3395176f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722991b2960886eaf99895ba3395176f">&#9670;&#160;</a></span>bluesync_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bluesync_init </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the BlueSync time synchronization module. </p>
<p>This function sets up internal data structures, mutexes, and state variables required for BlueSync to operate. It should be called once at startup before any synchronization or logical time queries are made. </p>

<p class="definition">Definition at line <a class="el" href="bluesync_8c_source.html#l00634">634</a> of file <a class="el" href="bluesync_8c_source.html">bluesync.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  634</span>                    {</div>
<div class="line"><span class="lineno">  635</span>    LOG_DBG(<span class="stringliteral">&quot;bluesync init&quot;</span>);</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    k_tid_t thread_id = k_thread_create(&amp;<a class="code hl_variable" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.bluesync_thread, bluesync_thread_stack,</div>
<div class="line"><span class="lineno">  638</span>                                      K_THREAD_STACK_SIZEOF(bluesync_thread_stack),</div>
<div class="line"><span class="lineno">  639</span>                                      <a class="code hl_function" href="bluesync_8c.html#a21bfb7737b28b272a313aac9db321aaf">bluesync_thread_fnt</a>, &amp;<a class="code hl_variable" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>, NULL, NULL,</div>
<div class="line"><span class="lineno">  640</span>                                      CONFIG_BLUESYNC_THREAD_PRIORITY, 0, K_NO_WAIT);</div>
<div class="line"><span class="lineno">  641</span>    k_thread_name_set(thread_id, <span class="stringliteral">&quot;bluesync_thread&quot;</span>);</div>
<div class="line"><span class="lineno">  642</span>}</div>
<div class="ttc" id="abluesync_8c_html_a21bfb7737b28b272a313aac9db321aaf"><div class="ttname"><a href="bluesync_8c.html#a21bfb7737b28b272a313aac9db321aaf">bluesync_thread_fnt</a></div><div class="ttdeci">void bluesync_thread_fnt(void *arg1, void *arg2, void *arg3)</div><div class="ttdef"><b>Definition</b> <a href="bluesync_8c_source.html#l00585">bluesync.c:585</a></div></div>
<div class="ttc" id="abluesync_8c_html_aef8cb9436cbb84d87beadf7b0d862d4b"><div class="ttname"><a href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a></div><div class="ttdeci">static struct bluesync_param param</div><div class="ttdef"><b>Definition</b> <a href="bluesync_8c_source.html#l00050">bluesync.c:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bluesync_8c.html#a21bfb7737b28b272a313aac9db321aaf">bluesync_thread_fnt()</a>, and <a class="el" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a722991b2960886eaf99895ba3395176f_cgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a722991b2960886eaf99895ba3395176f_cgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a722991b2960886eaf99895ba3395176f_cgraph" id="ainclude_2bluesync_2bluesync_8h_a722991b2960886eaf99895ba3395176f_cgraph">
<area shape="rect" title="Initializes the BlueSync time synchronization module." alt="" coords="5,120,102,146"/>
<area shape="rect" href="bluesync_8c.html#a21bfb7737b28b272a313aac9db321aaf" title=" " alt="" coords="150,120,287,146"/>
<area shape="poly" title=" " alt="" coords="102,130,134,130,134,136,102,136"/>
<area shape="rect" href="bluesync_8c.html#ae50107a7d06bfb4985ecbe2800d21bfe" title=" " alt="" coords="352,5,477,31"/>
<area shape="poly" title=" " alt="" coords="232,117,275,80,334,41,348,35,350,39,336,46,278,84,235,122"/>
<area shape="rect" href="bluesync_8c.html#aa16c1884bb8d3e76f7e0b221988d8906" title=" " alt="" coords="338,55,491,96"/>
<area shape="poly" title=" " alt="" coords="264,117,328,98,329,103,266,122"/>
<area shape="rect" href="bs__state__machine_8c.html#ad709ebb4c9b77535d7773f11f52dd751" title="Annonce an event to the state machine." alt="" coords="554,120,706,146"/>
<area shape="poly" title=" " alt="" coords="288,130,538,130,538,136,288,136"/>
<area shape="rect" href="bs__state__machine_8c.html#a53d51bafaea759128ff2e086cd372e6c" title="Init the state machine by passing the list of callbacks." alt="" coords="339,171,490,196"/>
<area shape="poly" title=" " alt="" coords="272,144,348,164,347,169,270,149"/>
<area shape="rect" href="bluesync_8c.html#a1bede3fdaf14c6f6462fe25bca0df18b" title=" " alt="" coords="335,220,494,246"/>
<area shape="poly" title=" " alt="" coords="238,144,281,175,336,206,349,212,347,217,334,211,278,179,235,148"/>
<area shape="rect" href="bluesync_8c.html#a73d14c438328054c5c14b084b3befe54" title=" " alt="" coords="542,5,718,31"/>
<area shape="poly" title=" " alt="" coords="491,53,563,33,565,38,492,58"/>
<area shape="rect" href="bs__state__machine_8c.html#a4c0f6002608b7ff932018f3570981ee8" title="Get the current state." alt="" coords="554,55,706,96"/>
<area shape="poly" title=" " alt="" coords="492,73,538,73,538,78,492,78"/>
<area shape="poly" title=" " alt="" coords="492,93,565,113,563,118,491,98"/>
<area shape="rect" href="bluesync__bitfields_8c.html#a835ad1bade618a08ef4ca2a30d8fc470" title="Set a specific bit in the bitfield." alt="" coords="773,5,833,31"/>
<area shape="poly" title=" " alt="" coords="718,16,757,16,757,21,718,21"/>
<area shape="rect" href="bs__state__machine_8c.html#a11a8e1f6a177592af3f6958c481bcf79" title=" " alt="" coords="766,120,840,146"/>
<area shape="poly" title=" " alt="" coords="706,130,750,130,750,136,706,136"/>
</map>
</div>

</div>
</div>
<a id="a0fd22af69afb2d05130825f473adda13" name="a0fd22af69afb2d05130825f473adda13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fd22af69afb2d05130825f473adda13">&#9670;&#160;</a></span>bluesync_set_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bluesync_set_role </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a></td>          <td class="paramname"><span class="paramname"><em>role</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the operational role of the BlueSync node. </p>
<p>This function configures the role of the device within the BlueSync synchronization system. Roles define whether the device acts as a time authority or as a time client within the network.</p>
<p>A <b>time authority</b> is the unique source of reference time and distributes it throughout the network. A <b>time client</b> receives synchronization from the authority or other clients and can forward the synchronized time further once it is synchronized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role</td><td>The role to assign to the device. Must be one of the values defined in the <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310b">bluesync_role_t</a> enumeration:<ul>
<li>BLUESYNC_AUTHORITY_ROLE</li>
<li>BLUESYNC_CLIENT_ROLE </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bluesync_8c_source.html#l00644">644</a> of file <a class="el" href="bluesync_8c_source.html">bluesync.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>                                            {</div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">if</span> (role != <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021">BLUESYNC_NONE_ROLE</a>) {</div>
<div class="line"><span class="lineno">  646</span>        <a class="code hl_function" href="bs__state__machine_8c.html#a83902f96272bc4d25ba545d9bd683c62">bs_state_machine_set_role</a>(role);</div>
<div class="line"><span class="lineno">  647</span>        k_sem_give(&amp;bluesync_role_assign_sem);</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  650</span>        LOG_ERR(<span class="stringliteral">&quot;Wrong type given&quot;</span>);</div>
<div class="line"><span class="lineno">  651</span>    }</div>
<div class="line"><span class="lineno">  652</span>}</div>
<div class="ttc" id="abs__state__machine_8c_html_a83902f96272bc4d25ba545d9bd683c62"><div class="ttname"><a href="bs__state__machine_8c.html#a83902f96272bc4d25ba545d9bd683c62">bs_state_machine_set_role</a></div><div class="ttdeci">void bs_state_machine_set_role(bluesync_role_t role)</div><div class="ttdoc">Indicate the role to the state machine.</div><div class="ttdef"><b>Definition</b> <a href="bs__state__machine_8c_source.html#l00160">bs_state_machine.c:160</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310ba91d7888de37627e71c6a743f1a8ba021">BLUESYNC_NONE_ROLE</a>, and <a class="el" href="bs__state__machine_8c.html#a83902f96272bc4d25ba545d9bd683c62">bs_state_machine_set_role()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a0fd22af69afb2d05130825f473adda13_cgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a0fd22af69afb2d05130825f473adda13_cgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a0fd22af69afb2d05130825f473adda13_cgraph" id="ainclude_2bluesync_2bluesync_8h_a0fd22af69afb2d05130825f473adda13_cgraph">
<area shape="rect" title="Sets the operational role of the BlueSync node." alt="" coords="5,5,131,31"/>
<area shape="rect" href="bs__state__machine_8c.html#a83902f96272bc4d25ba545d9bd683c62" title="Indicate the role to the state machine." alt="" coords="179,5,359,31"/>
<area shape="poly" title=" " alt="" coords="131,16,163,16,163,21,131,21"/>
</map>
</div>

</div>
</div>
<a id="a4690b69707910bec50799ce1911f4af2" name="a4690b69707910bec50799ce1911f4af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4690b69707910bec50799ce1911f4af2">&#9670;&#160;</a></span>bluesync_start_net_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bluesync_start_net_sync </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates a new BlueSync synchronization round as the time authority. </p>
<p>This function is called by the node acting as the time authority to start a network-wide synchronization round. It broadcasts timing information to all clients, allowing them to synchronize their local clocks based on the authority's reference time.</p>
<p>This function should only be called by devices assigned the <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>. </p>

<p class="definition">Definition at line <a class="el" href="bluesync_8c_source.html#l00655">655</a> of file <a class="el" href="bluesync_8c_source.html">bluesync.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  655</span>                              {</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf">bs_state_machine_get_role</a>() == <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>){</div>
<div class="line"><span class="lineno">  657</span>        k_mutex_lock(&amp;<a class="code hl_variable" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.mutex, K_FOREVER);</div>
<div class="line"><span class="lineno">  658</span>        {</div>
<div class="line"><span class="lineno">  659</span>            <a class="code hl_variable" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.current_round_id++;</div>
<div class="line"><span class="lineno">  660</span>        }</div>
<div class="line"><span class="lineno">  661</span>        k_mutex_unlock(&amp;<a class="code hl_variable" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.mutex);</div>
<div class="line"><span class="lineno">  662</span>        k_sem_give(&amp;bluesync_start_new_sync_sem);</div>
<div class="line"><span class="lineno">  663</span>    }</div>
<div class="line"><span class="lineno">  664</span>}</div>
<div class="ttc" id="abs__state__machine_8c_html_a8e7148a913121150be60bd92a69f3cbf"><div class="ttname"><a href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf">bs_state_machine_get_role</a></div><div class="ttdeci">bluesync_role_t bs_state_machine_get_role()</div><div class="ttdoc">Get the node role.</div><div class="ttdef"><b>Definition</b> <a href="bs__state__machine_8c_source.html#l00184">bs_state_machine.c:184</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>, <a class="el" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf">bs_state_machine_get_role()</a>, and <a class="el" href="bluesync_8c.html#aef8cb9436cbb84d87beadf7b0d862d4b">param</a>.</p>

<p class="reference">Referenced by <a class="el" href="#a523e1397bf700b1ab25182c0db4017c6">bluesync_start_net_sync_with_unix_epoch_us()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_cgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_cgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_cgraph" id="ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_cgraph">
<area shape="rect" title="Initiates a new BlueSync synchronization round as the time authority." alt="" coords="5,5,170,31"/>
<area shape="rect" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf" title="Get the node role." alt="" coords="218,5,398,31"/>
<area shape="poly" title=" " alt="" coords="170,16,202,16,202,21,170,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_icgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_icgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_icgraph" id="ainclude_2bluesync_2bluesync_8h_a4690b69707910bec50799ce1911f4af2_icgraph">
<area shape="rect" title="Initiates a new BlueSync synchronization round as the time authority." alt="" coords="233,13,397,38"/>
<area shape="rect" href="bluesync_8c.html#a523e1397bf700b1ab25182c0db4017c6" title="Initiates a new BlueSync synchronization round as the time authority." alt="" coords="5,5,185,46"/>
<area shape="poly" title=" " alt="" coords="217,28,185,28,185,23,217,23"/>
</map>
</div>

</div>
</div>
<a id="a523e1397bf700b1ab25182c0db4017c6" name="a523e1397bf700b1ab25182c0db4017c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523e1397bf700b1ab25182c0db4017c6">&#9670;&#160;</a></span>bluesync_start_net_sync_with_unix_epoch_us()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bluesync_start_net_sync_with_unix_epoch_us </td>
          <td>(</td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>unix_epoch_us</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates a new BlueSync synchronization round as the time authority. </p>
<p>This function is called by the node acting as the time authority to start a network-wide synchronization round. It broadcasts timing information to all clients, allowing them to synchronize their local clocks based on the authority's reference time.</p>
<p>This function should only be called by devices assigned the <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">unix_epoch_ms</td><td>: unix epoch reference in us </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bluesync_8c_source.html#l00666">666</a> of file <a class="el" href="bluesync_8c_source.html">bluesync.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  666</span>                                                                       {</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf">bs_state_machine_get_role</a>() == <a class="code hl_enumvalue" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>){</div>
<div class="line"><span class="lineno">  668</span>        <span class="comment">//set the new reference unix_epoch</span></div>
<div class="line"><span class="lineno">  669</span>        <a class="code hl_function" href="local__time_8c.html#a129e568095d5d38c8bff447987d28132">set_new_epoch_unix_ref</a>(unix_epoch_us);</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>        <span class="comment">//start a new sync in the network</span></div>
<div class="line"><span class="lineno">  672</span>        <a class="code hl_function" href="bluesync_8c.html#a4690b69707910bec50799ce1911f4af2">bluesync_start_net_sync</a>();</div>
<div class="line"><span class="lineno">  673</span>    }</div>
<div class="line"><span class="lineno">  674</span>}</div>
<div class="ttc" id="abluesync_8c_html_a4690b69707910bec50799ce1911f4af2"><div class="ttname"><a href="bluesync_8c.html#a4690b69707910bec50799ce1911f4af2">bluesync_start_net_sync</a></div><div class="ttdeci">void bluesync_start_net_sync()</div><div class="ttdoc">Initiates a new BlueSync synchronization round as the time authority.</div><div class="ttdef"><b>Definition</b> <a href="bluesync_8c_source.html#l00655">bluesync.c:655</a></div></div>
<div class="ttc" id="alocal__time_8c_html_a129e568095d5d38c8bff447987d28132"><div class="ttname"><a href="local__time_8c.html#a129e568095d5d38c8bff447987d28132">set_new_epoch_unix_ref</a></div><div class="ttdeci">void set_new_epoch_unix_ref(uint64_t epoch_ref_us)</div><div class="ttdoc">Set the new epoch unix ref value. Before the authority node starts a new network synchronisation,...</div><div class="ttdef"><b>Definition</b> <a href="local__time_8c_source.html#l00112">local_time.c:112</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab90d76e2e617bc596e11fe05aa0b310baec375b3206ba429a0bec529a70b5da0a">BLUESYNC_AUTHORITY_ROLE</a>, <a class="el" href="bluesync_8c.html#a4690b69707910bec50799ce1911f4af2">bluesync_start_net_sync()</a>, <a class="el" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf">bs_state_machine_get_role()</a>, and <a class="el" href="local__time_8c.html#a129e568095d5d38c8bff447987d28132">set_new_epoch_unix_ref()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a523e1397bf700b1ab25182c0db4017c6_cgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a523e1397bf700b1ab25182c0db4017c6_cgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a523e1397bf700b1ab25182c0db4017c6_cgraph" id="ainclude_2bluesync_2bluesync_8h_a523e1397bf700b1ab25182c0db4017c6_cgraph">
<area shape="rect" title="Initiates a new BlueSync synchronization round as the time authority." alt="" coords="5,48,185,89"/>
<area shape="rect" href="bluesync_8c.html#a4690b69707910bec50799ce1911f4af2" title="Initiates a new BlueSync synchronization round as the time authority." alt="" coords="233,5,397,31"/>
<area shape="poly" title=" " alt="" coords="185,45,241,32,242,38,186,51"/>
<area shape="rect" href="bs__state__machine_8c.html#a8e7148a913121150be60bd92a69f3cbf" title="Get the node role." alt="" coords="445,31,625,56"/>
<area shape="poly" title=" " alt="" coords="185,61,429,47,430,52,185,66"/>
<area shape="rect" href="local__time_8c.html#a129e568095d5d38c8bff447987d28132" title="Set the new epoch unix ref value. Before the authority node starts a new network synchronisation,..." alt="" coords="233,107,397,132"/>
<area shape="poly" title=" " alt="" coords="186,87,242,100,241,105,185,92"/>
<area shape="poly" title=" " alt="" coords="398,25,430,29,429,34,397,30"/>
</map>
</div>

</div>
</div>
<a id="a120ece7e147c0a90b3b973645f49af53" name="a120ece7e147c0a90b3b973645f49af53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120ece7e147c0a90b3b973645f49af53">&#9670;&#160;</a></span>get_current_unix_time_us()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t get_current_unix_time_us </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time which is based on the UNIX reference. </p>
<dl class="section return"><dt>Returns</dt><dd>return unix timestamp in microsecond in uint64_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="local__time_8c_source.html#l00138">138</a> of file <a class="el" href="local__time_8c_source.html">local_time.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>                                        {</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="local__time_8c.html#af7710aa86c6ea2d5bd9fd438e9f318fe">ticks_to_us_unix_time</a>(<a class="code hl_function" href="local__time_8c.html#ae7531b3c0b2ca2aa533b2ebd223cb7a0">get_logical_time_ticks</a>());</div>
<div class="line"><span class="lineno">  140</span>}</div>
<div class="ttc" id="alocal__time_8c_html_ae7531b3c0b2ca2aa533b2ebd223cb7a0"><div class="ttname"><a href="local__time_8c.html#ae7531b3c0b2ca2aa533b2ebd223cb7a0">get_logical_time_ticks</a></div><div class="ttdeci">uint64_t get_logical_time_ticks()</div><div class="ttdoc">Get the logical time ticks value. This is the corrected ticks value after synchronisation....</div><div class="ttdef"><b>Definition</b> <a href="local__time_8c_source.html#l00097">local_time.c:97</a></div></div>
<div class="ttc" id="alocal__time_8c_html_af7710aa86c6ea2d5bd9fd438e9f318fe"><div class="ttname"><a href="local__time_8c.html#af7710aa86c6ea2d5bd9fd438e9f318fe">ticks_to_us_unix_time</a></div><div class="ttdeci">uint64_t ticks_to_us_unix_time(uint64_t logical_tick)</div><div class="ttdef"><b>Definition</b> <a href="local__time_8c_source.html#l00126">local_time.c:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="local__time_8c.html#ae7531b3c0b2ca2aa533b2ebd223cb7a0">get_logical_time_ticks()</a>, and <a class="el" href="local__time_8c.html#af7710aa86c6ea2d5bd9fd438e9f318fe">ticks_to_us_unix_time()</a>.</p>

<p class="reference">Referenced by <a class="el" href="synced__time__logger_8c.html#a11d39f39b2a46eb250ca0b7b7e437748">my_work_handler()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_cgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_cgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_cgraph" id="ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_cgraph">
<area shape="rect" title="Get the current time which is based on the UNIX reference." alt="" coords="5,31,175,56"/>
<area shape="rect" href="local__time_8c.html#ae7531b3c0b2ca2aa533b2ebd223cb7a0" title="Get the logical time ticks value. This is the corrected ticks value after synchronisation...." alt="" coords="223,5,373,31"/>
<area shape="poly" title=" " alt="" coords="174,31,207,27,208,32,175,36"/>
<area shape="rect" href="local__time_8c.html#af7710aa86c6ea2d5bd9fd438e9f318fe" title=" " alt="" coords="223,55,373,80"/>
<area shape="poly" title=" " alt="" coords="175,51,208,54,207,60,174,56"/>
<area shape="rect" href="local__time_8c.html#a3de0db4d23103b2a5c83f9b27b39cf85" title=" " alt="" coords="421,5,578,31"/>
<area shape="poly" title=" " alt="" coords="373,16,405,16,405,21,373,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="include_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_icgraph.png" border="0" usemap="#ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_icgraph" alt=""/></div>
<map name="ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_icgraph" id="ainclude_2bluesync_2bluesync_8h_a120ece7e147c0a90b3b973645f49af53_icgraph">
<area shape="rect" title="Get the current time which is based on the UNIX reference." alt="" coords="942,5,1111,31"/>
<area shape="rect" href="synced__time__logger_8c.html#a11d39f39b2a46eb250ca0b7b7e437748" title=" " alt="" coords="772,5,894,31"/>
<area shape="poly" title=" " alt="" coords="926,21,894,21,894,16,926,16"/>
<area shape="rect" href="synced__time__logger_8c.html#ac60256ce352f8d3246b112015b649df1" title=" " alt="" coords="570,5,724,31"/>
<area shape="poly" title=" " alt="" coords="756,21,724,21,724,16,756,16"/>
<area shape="rect" href="synced__time__logger_8c.html#ab86379527d06d3811d91761b6ae57c5c" title="Initialize the timer that store regularly timestamp of the node." alt="" coords="362,5,522,31"/>
<area shape="poly" title=" " alt="" coords="554,21,523,21,523,16,554,16"/>
<area shape="rect" href="bluesync__statistic__bsim_8c.html#a931beb01090abe8ce0977b7c372647fa" title="Initialize the BlueSync statistics module." alt="" coords="165,5,314,31"/>
<area shape="poly" title=" " alt="" coords="347,21,315,21,315,16,347,16"/>
<area shape="rect" href="bluesync__statistic__bsim_8c.html#a99077ac5ea85d459dc83388437f6ccd3" title=" " alt="" coords="5,5,117,31"/>
<area shape="poly" title=" " alt="" coords="149,21,117,21,117,16,149,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
